*Motor commands*, or the coordinated actions between the brain and nervous system, enable the muscular movement of daily life. As the human body ages or suffers from neuromuscular disorders, the brain's motor commands degenerate, leading to difficulty in mobility and communication. Thus, it is imperative to study motor commands and the neural system that facilitates movement in our bodies. In this proposal, we aim to create a Python package that decomposes and visualizes the electrical signals sent from our brains to various muscles.

```{r emg-hardware, echo=FALSE, fig.cap = 'Application of surface electrodes to record electromyographs ("Electromyography: Encyclopedia Mdpi", n.d.).', fig.align="center", fig.pos="h"}
knitr::include_graphics(path="images/emg_hardware.png")
```

Electromyography (EMG) is used to quantify the net electrical charge of a muscle as it contracts. In non-invasive electromyography, surface electrodes are placed on the skin, as seen in the diagram in figure \@ref(fig:emg-hardware), and voltage is measured as participants flex and relax a muscle.

```{r emg-decomposition, echo=FALSE, fig.cap = "Decomposition of surface EMG signal into individual motor unit action potential spike trains (De Luca et al. (2006).", fig.align="center", fig.pos="h", out.width="70%"}
knitr::include_graphics(path="images/emg_decomposition.png")
```

The collected signal is the sum of all the electric action potentials fired from motor neurons attached to muscle fiber [@negro_muceli_castronovo_holobar_farina_2016\]. A motor neuron, along with its connected muscle fibres, is known as a motor unit \[@purves_2018\]. Decomposing the net EMG signal into the contributions of each individual motor unit, the process of which can be seen in figure \@ref(fig:emg-decomposition), provides crucial information in research areas such as motor neuron discharge behaviour and muscle architecture, which deepen our understanding of the human body and can be used in diagnosing muscular disorders \[@mcgill_lateva_marateb_2005\]\[@emg_decomposition_tutorial].

```{r OTBioelettronica-GUI, echo=FALSE, fig.cap = "Graphical user interface of the OT Biolettronica software.", fig.align="center", fig.pos="h", out.width="90%"}
knitr::include_graphics(path="images/ot_bioelettronica.jpeg")
```

Currently, the Sensorimotor Physiology Laboratory decomposes EMG signals using a free software from OT Bioelettronica, the graphical user interface (GUI) of which can be seen in figure \@ref(fig:OTBioelettronica-GUI). This software determines the individual motor unit action potential spike trains using a closed-source algorithm. This type of decomposition is known as a convolutive blind source separation algorithm and is based off a paper published by Negro et al (2016), which provides the mathematical logic and pseudocode used to build the algorithm. The algorithm employs high-level linear algebra and unsupervised learning techniques, such as Latent Component Analysis and K-Means classification.

The goal for this project is to recreate the blind-source separation algorithm described in Negro et al (2016). Primary steps of the algorithm are visually summarized in figure \@ref(fig:algo-visual-summary) below. The first three steps (I, II, III) are essentially data wrangling of the input signal, including extending of the channels and whitening of the resulting matrix. This data manipulation steps are followed by two fixed point algorithm iteration (IV and V), which utilize machine learning for optimal decomposition of signal into individual motor units. Step VI of the visualization displays the way that the quality of decomposition is estimated and improved at each iteration.

```{r algo-visual-summary, echo=FALSE, fig.cap = "Visual step-by-step summary of the blind-source separation algorithm from Negro et al paper.", fig.align="center", fig.pos="h", out.width="90%"}
knitr::include_graphics(path="images/algo_visual_summary.png")
```

Additionally, we hope to create a simple non-interactive visualization tool that allows users to view the deconstructed EMG signals. To fit the needs of the Sensorimotor Physiology Laboratory, we will modify the program to decompose EMG recordings of up to 5 minutes in length. Presently, the Bioelettronica software limits EMG decomposition to 100 second long recordings.

The final data product is a Python package, `EMGdecomPy`, that contains the decomposition algorithm and the visualization tool. We aim for `EMGdecomPy` to be open-source and transparent, so future parties can customize or further develop functionalities. To accomplish this, there will be a large emphasis on documentation throughout the development of the package. While made for the Sensorimotor Physiology Laboratory, it is our hope that `EMGdecomPy` will be a useful package to broadly explore the mechanisms underlying the brain's interactions with our muscles.
