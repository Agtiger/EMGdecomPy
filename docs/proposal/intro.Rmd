Motor neurons are the junction between the central nervous system and the muscular system, enabling the muscular movement of daily life [@purves_2018]. Degeneration of the motor neurons, through aging or neuromuscular disorders, therefore leads to difficulty in mobility and communication [@purves_2018]. Thus, it is imperative to study motor neurons and the neural system that facilitates movement in our bodies. In this proposal, we aim to create a Python package that decomposes and visualizes the electrical signals sent from our central nervous system through motor neurons to various muscles.

```{r emg-hardware, echo=FALSE, fig.cap = 'Obtaining electromyographs with a. surface electrodes and b. needle electrodes ("Electromyography: Encyclopedia Mdpi", n.d.).', fig.align="center", out.width="75%"}
knitr::include_graphics(path="images/emg_hardware.png")
```

Electromyography (EMG) is used to quantify the net electrical charge of a muscle as it contracts. Invasive electromyography involves the insertion of a needle electrode into the muscle, as pictured in **figure \@ref(fig:emg-hardware)a**. Invasive electromyography is the more commonly used technique, as it allows for deeper muscle groups to be accessed, and the manipulation of the electrode to sample different parts of the muscle and to optimize the signal (@emg_decomposition_tutorial). In non-invasive electromyography, surface electrodes are placed on the skin, as pictured in **figure \@ref(fig:emg-hardware)b**, and voltage is measured as participants flex and relax a muscle (@emg_decomposition_tutorial). This technique is the one that the capstone partner is interested in, and has advantages that include ease-of-use and more flexible applications. In addition, recent advances in technology and data science have increased the utility of non-invasive EMG, as raw EMG signals can now be decomposed into their constituent individual motor unit action potentials, whereas this was previously only feasible with invasive EMG [negro_muceli_castronovo_holobar_farina_2016].

```{r emg-decomposition, echo=FALSE, fig.cap = "Decomposition of surface EMG signal into individual motor unit action potential spike trains (De Luca et al. (2006).", fig.align="center", out.width="70%"}
knitr::include_graphics(path="images/emg_decomposition.png")
```

The raw EMG signal is the sum of all the electric action potentials fired from motor neurons attached to muscle fibres [@negro_muceli_castronovo_holobar_farina_2016]. A motor neuron, along with its connected muscle fibres, is known as a motor unit [@purves_2018]. Decomposing the raw EMG signal into the contributions of each individual motor unit, the process of which can be seen in **figure \@ref(fig:emg-decomposition)**, provides crucial information in research areas such as motor neuron discharge behaviour and muscle architecture, which deepen our understanding of the human body and can be used in diagnosing muscular disorders [@mcgill_lateva_marateb_2005][@emg_decomposition_tutorial].

```{r OTBioelettronica-GUI, echo=FALSE, fig.cap = "Graphical user interface of the OT Biolettronica software.", fig.align="center", out.width="90%"}
knitr::include_graphics(path="images/ot_bioelettronica.jpeg")
```

Currently, the Sensorimotor Physiology Laboratory decomposes EMG signals using a free software from OT Bioelettronica, the graphical user interface (GUI) of which can be seen in **figure \@ref(fig:OTBioelettronica-GUI)**. This software determines the individual motor unit action potential spike trains using a closed-source algorithm. This type of decomposition is known as a convolutive blind source separation algorithm and is based off a paper published by Negro et al (2016), which provides the mathematical logic and pseudocode used to build the algorithm. The algorithm employs high-level linear algebra and unsupervised learning techniques, such as Latent Component Analysis and K-Means classification.

The goal for this project is to recreate the blind-source separation algorithm described in Negro et al. (2016). Primary steps of the algorithm are visually summarized in **figure \@ref(fig:algo-visual-summary)**. The first three steps (I, II, III) are essentially data wrangling of the input signal, including extending of the channels and whitening of the resulting matrix. These data manipulation steps are followed by two fixed point algorithm iterations (IV and V), which utilize machine learning for the optimal decomposition of the signal into individual motor unit action potentials. Step VI of the visualization displays the way that the quality of decomposition is estimated and improved at each iteration.

```{r algo-visual-summary, echo=FALSE, fig.cap = "Visual step-by-step summary of the blind-source separation algorithm from Negro et al. (2016).", fig.align="center", fig.pos="h", out.width="90%"}
knitr::include_graphics(path="images/algo_visual_summary.png")
```

Additionally, we hope to create a simple non-interactive visualization tool that allows users to view the deconstructed EMG signals. To fit the needs of the Sensorimotor Physiology Laboratory, we will modify the program to decompose EMG recordings of up to 5 minutes in length. Presently, the OT Bioelettronica software limits EMG decomposition to 100 second long recordings.

The final data product is a Python package, `EMGdecomPy`, that contains the decomposition algorithm and the visualization tool. We aim for `EMGdecomPy` to be open-source and transparent, so future parties can customize or further develop functionalities. To accomplish this, there will be a large emphasis on documentation throughout the development of the package. While made for the Sensorimotor Physiology Laboratory, it is our hope that `EMGdecomPy` will be a useful package to broadly explore the mechanisms underlying the brain's interactions with our muscles.
